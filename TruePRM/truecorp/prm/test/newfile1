         SELECT col.ACCOUNT_ID, 
                                to_char(col.COL_NEXT_STEP_DATE,'dd/mm/yyyy') as COL_NEXT_STEP_DATE , 
                                col.COL_PAST_DUE_AMOUNT , 
                                prod.PRODUCT_TYPE, 
                                prod.PRODUCT_NO, 
                                ca.CREDIT_CLASS, 
                                min(inv.INV_DUE_DATE) , 
                                to_char(inv.INV_DUE_DATE,'dd/mm/yyyy') as OLDEST_INV_DUE_DATE, 
                                ca.CYCLE_CODE, 
                                ca.ACCOUNT_STATUS, 
                                ca.STATUS_ACTV_RSN_CODE, 
                                ca.ACCOUNT_TYPE, 
                                ca.ACCOUNT_SUB_TYPE 
                            FROM COLLECTION  col 
                             left join PRODUCT prod  
                                   on prod.ACCOUNT_ID = col.ACCOUNT_ID  
                                      and prod.PRODUCT_TYPE ='A' 
                             left join CUSTOMER_ACCOUNT ca on trim(ca.ACCOUNT_ID) = trim(col.ACCOUNT_ID) 
                             left join INVOICE  inv on trim(inv.ACCOUNT_ID) = trim(col.ACCOUNT_ID) 
                             WHERE col.COL_ACTV_DATE = to_date('"+logicalDate+"','yyyymmdd') 
                                   AND col.COL_ACTV_CODE = 'PD'  
                                   and prod.PRODUCT_TYPE ='A'  
                             group by col.ACCOUNT_ID,to_char(col.COL_NEXT_STEP_DATE,'dd/mm/yyyy'), 
                                      col.COL_PAST_DUE_AMOUNT ,prod.PRODUCT_TYPE,prod.PRODUCT_NO, 
                                      ca.CREDIT_CLASS,to_char(inv.INV_DUE_DATE,'dd/mm/yyyy'),ca.CYCLE_CODE, 
                                      ca.ACCOUNT_STATUS, ca.STATUS_ACTV_RSN_CODE,ca.ACCOUNT_TYPE,ca.ACCOUNT_SUB_TYPE 